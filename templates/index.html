{%load static%}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Mosaddek">
    <meta name="keyword" content="FlatLab, Dashboard, Bootstrap, Admin, Template, Theme, Responsive, Fluid, Retina">
    <link rel="shortcut icon" href="{% static 'img/favicon.html' %}">


    <title>首页</title>

    <!-- Bootstrap core CSS -->
    <link href="{% static '/css/bootstrap.min.css' %}" rel="stylesheet">
    <link href="{% static '/css/bootstrap-reset.css' %}" rel="stylesheet">
    <!--external css-->
    <link href="{% static '/assets/font-awesome/css/font-awesome.css' %}" rel="stylesheet" />
    <link href="{% static '/assets/jquery-easy-pie-chart/jquery.easy-pie-chart.css' %}" rel="stylesheet" type="text/css" media="screen"/>
    <link rel="stylesheet" href="{% static '/css/owl.carousel.css' %}" type="text/css">
    <!-- Custom styles for this template -->
    <link href="{% static '/css/style.css' %}" rel="stylesheet">
    <link href="{% static '/css/style-responsive.css' %}" rel="stylesheet" />

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 tooltipss and media queries -->
    <!--[if lt IE 9]>
      <script src="js/html5shiv.js"></script>
      <script src="js/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

  <section id="container" class="">
      <!--header start-->
      <header class="header white-bg">
            <div class="sidebar-toggle-box">
                <div data-original-title="Toggle Navigation" data-placement="right" class="icon-reorder tooltips"></div>
            </div>
            <!--logo start-->
            <a href="#" class="logo">Zeru<span>lab</span></a>
            <!--logo end-->
            
            <div class="top-nav ">
                <!--search & user info start-->
                <ul class="nav pull-right top-menu">
                    <li>
                        <input type="text" class="form-control search" placeholder="Search">
                    </li>
                    <!-- user login dropdown start-->
                    <li class="dropdown">
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#">
							<img alt="" src="{% static 'img/avatar1_small.jpg' %}">
                            <span class="username">{{ request.user }}</span>
                            <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu extended logout">
                            <div class="log-arrow-up"></div>
                            <li><a href="{% url 'logout' %}"><i class="icon-key"></i> Log Out</a></li>
                        </ul>
                    </li>
                    <!-- user login dropdown end -->
                </ul>
                <!--search & user info end-->
            </div>
        </header>
      <!--header end-->
      <!--sidebar start-->
      <aside>
          <div id="sidebar"  class="nav-collapse ">
              <!-- sidebar menu start-->
              <ul class="sidebar-menu">
                  <li class="active">
                      <a class="" href="{% url 'index' %}">
                          <i class="icon-dashboard"></i>
                          <span>Dashboard</span>
                      </a>
                  </li>
				  <li class="sub-menu">
                      <a class="" href="{% url 'monitor' %}">
                          <i class="icon-desktop"></i>
                          <span>文件监控</span>
                      </a>
                  </li>
                  <li class="sub-menu">
                      <a href="javascript:;" class="">
                          <i class="icon-tasks"></i>
                          <span>系统信息</span>
                          <span class="arrow"></span>
                      </a>
                      <ul class="sub">
                          <li><a class="" href="{% url 'system' %}">主机信息</a></li>
                          <li><a class="" href="{% url 'version' %}">内核信息</a></li>
                          <li><a class="" href="{% url 'memory' %}">内存信息</a></li>
						  <li><a class="" href="{% url 'user' %}">主机用户</a></li>
						  <li><a class="" href="{% url 'processes' %}">主机进程</a></li>
						  <li><a class="" href="{% url 'crontab' %}">计划任务</a></li>
						  <li><a class="" href="{% url 'hidden' %}">隐藏文件</a></li>
						  <li><a class="" href="{% url 'shell' %}">终端连接</a></li>
						  <li><a class="" href="{% url 'port' %}">端口开放</a></li>
                          <li><a class="" href="{% url 'bean' %}">反弹shell</a></li>
                      </ul>
                  </li>
                  
				  <li class="sub-menu">
                      <a class="" href="{% url 'cve' %}">
                          <i class="icon-cogs"></i>
                          <span>CVE监控</span>
                      </a>
                  </li>
                  <li>
                      <a class="" href="{% url 'inbox' %}">
                          <i class="icon-envelope"></i>
                          <span>新消息</span>
                          <span class="label label-danger pull-right mail-info">{{ mesnum }}</span>
                      </a>
                  </li>
                  <li class="sub-menu">
                      <a href="javascript:;" class="">
                          <i class="icon-th"></i>
                          <span>系统设置</span>
                          <span class="arrow"></span>
                      </a>
                      <ul class="sub">
                          <li><a class="" href="{% url 'host' %}">配置设置</a></li>
                          <li><a class="" href="{% url 'profile' %}">个人设置</a></li>
                      </ul>
                  </li>
              </ul>
              <!-- sidebar menu end-->
          </div>
      </aside>
      <!--sidebar end-->
      <!--main content start-->
      <section id="main-content">
          <section class="wrapper">
              <!--state overview start-->
              <div style="display: flex">  <!-- 父div，水平布置-->
				<div id="first-echarts" style="width:450px;height:350px;"></div>
				<!-- <div id="second-echarts" style="width:450px;height:350px;" style="float:right"></div> -->
				<!-- <div class="panel" style="width:400px;height:200px;"> -->
				  <div class="panel-body" style="width:400px;height:100px;margin-top:50px">
					  
					  <div class="bio-desk">
						  <h2 class="terques">ZERU LAB</h2>
						  <h4>User : {{ request.user.username }}</h4>
						  <h4>Started : {% now "Y-m-d H:i" %}</h4>
					  </div>
				  </div>
			    <!-- </div> -->
				<div id="three-echarts" style="width:450px;height:350px;" style="float:right"></div>
			  </div>
			  <div style="display: flex">  <!-- 父div，水平布置-->
				<div id="four-echarts" style="width:1500px;height:350px;"></div>
			  </div>
              <!--state overview end-->
          </section>
      </section>
      <!--main content end-->
  </section>

    <!-- js placed at the end of the document so the pages load faster -->
    <script src="{% static '/js/jquery.js' %}"></script>
    <script src="{% static '/js/jquery-1.8.3.min.js' %}"></script>
    <script src="{% static '/js/bootstrap.min.js' %}"></script>
    <script src="{% static '/js/jquery.scrollTo.min.js' %}"></script>
    <script src="{% static '/js/jquery.nicescroll.js' %}" type="text/javascript"></script>
    <script src="{% static '/js/jquery.sparkline.js' %}" type="text/javascript"></script>
    <script src="{% static '/assets/jquery-easy-pie-chart/jquery.easy-pie-chart.js' %}"></script>
    <script src="{% static '/js/owl.carousel.js' %}" ></script>
    <script src="{% static '/js/jquery.customSelect.min.js' %}" ></script>
    <!--common script for all pages-->
    <script src="{% static '/js/common-scripts.js' %}"></script>
    <script src="{% static '/js/echarts.js' %}"></script>
	<script src="{% static 'js/all-chartjs.js' %}"></script>
	<script src="{% static 'js/sparkline-chart.js' %}"></script>

    <!--script for this page-->

  <script>

      //owl carousel

      $(document).ready(function() {
          $("#owl-demo").owlCarousel({
              navigation : true,
              slideSpeed : 300,
              paginationSpeed : 400,
              singleItem : true

          });
      });

      //custom select box

      $(function(){
          $('select.styled').customSelect();
      });
	
  </script>
	<script type="text/javascript">
	var myChart = echarts.init(document.getElementById('first-echarts'));
	option = {
	title: {
        text: '各数量占比',
        left: 'center'
    },
    tooltip: {
        trigger: 'item',
        formatter: '{a} <br/>{b}: {c} ({d}%)'
    },
    legend: {
        type: 'scroll',
        orient: 'vertical',
        left: 10,
        data: ['文件监控', '进程监控', '定时任务', '隐藏文件', '开放端口'],
    },
    series: [
        {
            name: '访问来源',
            type: 'pie',
            radius: '70%',
            avoidLabelOverlap: false,
            label: {
                show: false,
                position: 'center'
            },
            emphasis: {
                itemStyle: {
                    shadowBlur: 10,
                    shadowOffsetX: 0,
                    shadowColor: 'rgba(0, 0, 0, 0.5)'
                }
            },
            labelLine: {
                show: false
            },
            data: [
                {value: {{ echart1|slice:":1" }}, name: '文件监控'},
                {value: {{ echart1|slice:"1:2" }}, name: '进程监控'},
                {value: {{ echart1|slice:"2:3" }}, name: '定时任务'},
                {value: {{ echart1|slice:"3:4" }}, name: '隐藏文件'},
                {value: {{ echart1|slice:"-1:" }}, name: '开放端口'}
				]
			}
		]
	};
	myChart.setOption(option);
	
	var myChart = echarts.init(document.getElementById('three-echarts'));
	option3 = {
		title: {
			text: 'CVE数量变化',
		},
		xAxis: {
			type: 'category',
			data: ['今天', '昨天', '三天前', '四天前', '五天前', '六天前', '七天前']
		},
		yAxis: {
			type: 'value'
		},
		series: [{
			data: {{ echart2 }},
			type: 'bar',
			showBackground: true,
			backgroundStyle: {
				color: 'rgba(220, 220, 220, 0.8)'
			}
		}]
	};

	myChart.setOption(option3);
	
	var myChart = echarts.init(document.getElementById('four-echarts'));
	option4 = {
    title: {
        text: '近十五天数据变化'
    },
    tooltip: {
        trigger: 'axis',
        axisPointer: {
            type: 'cross',
            label: {
                backgroundColor: '#6a7985'
            }
        }
    },
    legend: {
        data: ['文件监控', '进程监控', '定时任务', '隐藏文件', '端口开放', '终端连接']
    },
    toolbox: {
        feature: {
            saveAsImage: {}
        }
    },
    grid: {
        left: '3%',
        right: '4%',
        bottom: '3%',
        containLabel: true
    },
    xAxis: [
        {
            type: 'category',
            boundaryGap: false,
            data: {{ days|safe }}
        }
    ],
    yAxis: [
        {
            type: 'value'
        }
    ],
    series: [
        {
            name: '文件监控',
            type: 'line',
            stack: '总量',
            areaStyle: {},
            data: {{ echart4.filenum }}
        },
        {
            name: '进程监控',
            type: 'line',
            stack: '总量',
            areaStyle: {},
            data: {{ echart4.process }}
        },
        {
            name: '定时任务',
            type: 'line',
            stack: '总量',
            areaStyle: {},
            data: {{ echart4.crontab}}
        },
        {
            name: '隐藏文件',
            type: 'line',
            stack: '总量',
            areaStyle: {},
            data: {{ echart4.hidden }}
        },
        {
            name: '端口开放',
            type: 'line',
            stack: '总量',
            label: {
                normal: {
                    show: true,
                    position: 'top'
                }
            },
            areaStyle: {},
            data: {{ echart4.open_port }}
        },
		{
            name: '终端连接',
            type: 'line',
            stack: '总量',
            areaStyle: {},
            data: {{ echart4.shell_tty }}
        }
    ]
	};
	myChart.setOption(option4);
	</script>
  </body>
</html>
